# NestJS æŠ€æœ¯æ ˆå¯è¡Œæ€§åˆ†ææŠ¥å‘Š

## ğŸ“Š å¯è¡Œæ€§æ€»ç»“

**æ¨èæŒ‡æ•°: â­â­â­â­â­ (å¼ºçƒˆæ¨è)**

NestJS éå¸¸é€‚åˆä½œä¸º MCP Swagger API çš„åç«¯æŠ€æœ¯æ ˆï¼Œå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒä¼˜åŠ¿ï¼š

- âœ… **å®Œç¾å¥‘åˆé¡¹ç›®éœ€æ±‚**: åŸç”ŸTypeScriptæ”¯æŒï¼Œä¸ç°æœ‰é¡¹ç›®æŠ€æœ¯æ ˆæ— ç¼é›†æˆ
- âœ… **ä¼ä¸šçº§ç‰¹æ€§**: å†…ç½®ä¾èµ–æ³¨å…¥ã€æ¨¡å—åŒ–ã€ä¸­é—´ä»¶ç­‰ä¼ä¸šçº§ç‰¹æ€§
- âœ… **MCPåè®®å‹å¥½**: æ”¯æŒå¤šç§ä¼ è¾“åè®®ï¼Œæ˜“äºå®ç°MCP StreamableHTTP
- âœ… **APIç®¡ç†èƒ½åŠ›**: å†…ç½®Swaggeré›†æˆï¼Œä¾¿äºAPIæ–‡æ¡£ç®¡ç†
- âœ… **ç”Ÿäº§å°±ç»ª**: æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿï¼Œä¸°å¯Œçš„ä¸­é—´ä»¶å’Œæ’ä»¶

## ğŸ—ï¸ æ¶æ„å¯¹æ¯”åˆ†æ

### Express vs NestJS æ¶æ„å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Express (å½“å‰æ–¹æ¡ˆ)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ æ‰‹åŠ¨ç®¡ç†ä¾èµ–                                                 â”‚
â”‚ âŒ ç¼ºå°‘æ ‡å‡†åŒ–çš„é¡¹ç›®ç»“æ„                                         â”‚
â”‚ âŒ ä¸­é—´ä»¶ç®¡ç†å¤æ‚                                               â”‚
â”‚ âŒ ç¼ºå°‘å†…ç½®éªŒè¯å’Œåºåˆ—åŒ–                                         â”‚
â”‚ âŒ æ‰‹åŠ¨é”™è¯¯å¤„ç†                                                 â”‚
â”‚ âŒ ç¼ºå°‘æ¨¡å—åŒ–ç®¡ç†                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NestJS (æ¨èæ–¹æ¡ˆ)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… è‡ªåŠ¨ä¾èµ–æ³¨å…¥ (DI)                                            â”‚
â”‚ âœ… æ¨¡å—åŒ–æ¶æ„ï¼Œæ¸…æ™°çš„é¡¹ç›®ç»“æ„                                   â”‚
â”‚ âœ… è£…é¥°å™¨é©±åŠ¨ï¼Œä»£ç ç®€æ´                                         â”‚
â”‚ âœ… å†…ç½®éªŒè¯ã€åºåˆ—åŒ–ã€è½¬æ¢                                       â”‚
â”‚ âœ… å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨                                               â”‚
â”‚ âœ… å®ˆå«ã€æ‹¦æˆªå™¨ã€ç®¡é“ç­‰é«˜çº§ç‰¹æ€§                                 â”‚
â”‚ âœ… å†…ç½®Swaggeré›†æˆ                                              â”‚
â”‚ âœ… æ”¯æŒå¾®æœåŠ¡æ¶æ„                                               â”‚
â”‚ âœ… ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯æ ˆé€‰æ‹©ç†ç”±

### 1. ä¸ç°æœ‰é¡¹ç›®çš„å…¼å®¹æ€§

```typescript
// ç°æœ‰é¡¹ç›®æŠ€æœ¯æ ˆ
{
  "è¯­è¨€": "TypeScript",
  "åŒ…ç®¡ç†": "pnpm",  
  "æ„å»ºå·¥å…·": "Rollup",
  "å¼€å‘å·¥å…·": "ts-node, nodemon",
  "æ ¸å¿ƒåº“": "@mcp-swagger/parser"
}

// NestJS æŠ€æœ¯æ ˆ
{
  "è¯­è¨€": "TypeScript âœ… å®Œå…¨å…¼å®¹",
  "åŒ…ç®¡ç†": "pnpm âœ… å®Œå…¨æ”¯æŒ",
  "æ„å»ºå·¥å…·": "å†…ç½®Webpack/SWC âœ… æ›´å¼ºå¤§",
  "å¼€å‘å·¥å…·": "å†…ç½®hot-reload âœ… æ›´å¥½çš„å¼€å‘ä½“éªŒ",
  "æ ¸å¿ƒåº“": "å¯ç›´æ¥ä½¿ç”¨ âœ… æ— éœ€ä¿®æ”¹"
}
```

### 2. MCPåè®®å®ç°ä¼˜åŠ¿

```typescript
// Express å®ç° MCP StreamableHTTP (å¤æ‚)
app.post('/mcp', async (req, res) => {
  // æ‰‹åŠ¨å¤„ç†è¯·æ±‚å¤´
  // æ‰‹åŠ¨ç®¡ç†ä¼šè¯
  // æ‰‹åŠ¨é”™è¯¯å¤„ç†
  // æ‰‹åŠ¨JSON-RPCåè®®å¤„ç†
});

// NestJS å®ç° MCP StreamableHTTP (ç®€æ´)
@Controller('mcp')
@UseInterceptors(MCPInterceptor)
export class MCPController {
  @Post()
  @UseGuards(MCPSessionGuard)
  async handleMCP(@Body() request: MCPRequest): Promise<MCPResponse> {
    // è‡ªåŠ¨éªŒè¯ã€åºåˆ—åŒ–
    // è‡ªåŠ¨é”™è¯¯å¤„ç†
    // æ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘
    return this.mcpService.handle(request);
  }
}
```

### 3. ä¼ä¸šçº§ç‰¹æ€§æ”¯æŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NestJS ä¼ä¸šçº§ç‰¹æ€§                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ” Authentication & Authorization                               â”‚
â”‚    â€¢ å†…ç½® JWT æ”¯æŒ                                              â”‚
â”‚    â€¢ å¤šç§è®¤è¯ç­–ç•¥ (Bearer, Basic, Custom)                      â”‚
â”‚    â€¢ ç»†ç²’åº¦æƒé™æ§åˆ¶                                             â”‚
â”‚                                                                 â”‚
â”‚ ğŸ“Š ç›‘æ§ä¸æ—¥å¿—                                                   â”‚
â”‚    â€¢ å†…ç½® Logger æœåŠ¡                                           â”‚
â”‚    â€¢ å¥åº·æ£€æŸ¥ç«¯ç‚¹                                               â”‚
â”‚    â€¢ æ€§èƒ½ç›‘æ§é›†æˆ                                               â”‚
â”‚                                                                 â”‚
â”‚ ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§                                                     â”‚
â”‚    â€¢ å†…ç½® CORS æ”¯æŒ                                             â”‚
â”‚    â€¢ è¯·æ±‚é™æµ (Rate Limiting)                                   â”‚
â”‚    â€¢ è¾“å…¥éªŒè¯å’Œå‡€åŒ–                                             â”‚
â”‚                                                                 â”‚
â”‚ ğŸ§ª æµ‹è¯•æ”¯æŒ                                                     â”‚
â”‚    â€¢ å†…ç½®æµ‹è¯•æ¡†æ¶ (Jest)                                        â”‚
â”‚    â€¢ ç«¯åˆ°ç«¯æµ‹è¯•æ”¯æŒ                                             â”‚
â”‚    â€¢ Mock æœåŠ¡                                                  â”‚
â”‚                                                                 â”‚
â”‚ ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–                                                     â”‚
â”‚    â€¢ å†…ç½®ç¼“å­˜ç®¡ç†                                               â”‚
â”‚    â€¢ å‹ç¼©å’Œä¼˜åŒ–                                                 â”‚
â”‚    â€¢ è¿æ¥æ± ç®¡ç†                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ é¡¹ç›®åŒ¹é…åº¦åˆ†æ

### æ ¸å¿ƒéœ€æ±‚åŒ¹é…

| é¡¹ç›®éœ€æ±‚ | NestJS æ”¯æŒ | åŒ¹é…åº¦ | è¯´æ˜ |
|---------|-------------|--------|------|
| OpenAPIè§£æ | âœ… å®Œç¾æ”¯æŒ | â­â­â­â­â­ | å¯ç›´æ¥ä½¿ç”¨ç°æœ‰@mcp-swagger/parser |
| MCPåè®®å®ç° | âœ… çµæ´»æ”¯æŒ | â­â­â­â­â­ | è£…é¥°å™¨æ¨¡å¼éå¸¸é€‚åˆMCPåè®® |
| åŠ¨æ€å·¥å…·æ³¨å†Œ | âœ… åŸç”Ÿæ”¯æŒ | â­â­â­â­â­ | ä¾èµ–æ³¨å…¥å’Œæ¨¡å—åŒ–å®Œç¾å¥‘åˆ |
| HTTP Stream | âœ… å®Œå…¨æ”¯æŒ | â­â­â­â­â­ | å†…ç½®æµå¤„ç†å’ŒWebSocketæ”¯æŒ |
| é…ç½®ç®¡ç† | âœ… å†…ç½®åŠŸèƒ½ | â­â­â­â­â­ | ConfigServiceå’Œç¯å¢ƒå˜é‡ç®¡ç† |
| å®æ—¶é€šä¿¡ | âœ… å¤šç§æ–¹æ¡ˆ | â­â­â­â­â­ | SSEã€WebSocketã€HTTP Stream |
| é”™è¯¯å¤„ç† | âœ… å…¨å±€æ”¯æŒ | â­â­â­â­â­ | å¼‚å¸¸è¿‡æ»¤å™¨å’Œæ ‡å‡†åŒ–é”™è¯¯ |
| APIæ–‡æ¡£ | âœ… è‡ªåŠ¨ç”Ÿæˆ | â­â­â­â­â­ | å†…ç½®Swaggeré›†æˆ |

### æŠ€æœ¯ç”Ÿæ€åŒ¹é…

```
ç°æœ‰é¡¹ç›®ç”Ÿæ€:
â”œâ”€â”€ TypeScript âœ… NestJSåŸç”Ÿæ”¯æŒ
â”œâ”€â”€ pnpm âœ… å®Œå…¨å…¼å®¹
â”œâ”€â”€ Monorepo âœ… æ”¯æŒNxé›†æˆ
â”œâ”€â”€ Rollup âœ… å¯å…±å­˜ä½¿ç”¨
â”œâ”€â”€ ESLint âœ… å†…ç½®æ”¯æŒ
â””â”€â”€ Jest âœ… é»˜è®¤æµ‹è¯•æ¡†æ¶

NestJS ç”Ÿæ€å¢å¼º:
â”œâ”€â”€ ğŸ”§ CLIå·¥å…· (ä»£ç ç”Ÿæˆ)
â”œâ”€â”€ ğŸ›¡ï¸ å®‰å…¨æ¨¡å—
â”œâ”€â”€ ğŸ“Š ç›‘æ§é›†æˆ
â”œâ”€â”€ ğŸ§ª æµ‹è¯•å·¥å…·
â”œâ”€â”€ ğŸ“š æ–‡æ¡£ç”Ÿæˆ
â””â”€â”€ ğŸš€ éƒ¨ç½²æ”¯æŒ
```

## ğŸ“ˆ æ€§èƒ½ä¸å¯æ‰©å±•æ€§åˆ†æ

### æ€§èƒ½å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŒ‡æ ‡               â”‚ Express    â”‚ NestJS      â”‚ æå‡å¹…åº¦        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¯åŠ¨æ—¶é—´           â”‚ ~100ms     â”‚ ~200ms      â”‚ ç•¥æ…¢ (å¯æ¥å—)   â”‚
â”‚ å†…å­˜å ç”¨           â”‚ ~30MB      â”‚ ~45MB       â”‚ ç¨é«˜ (å¯æ¥å—)   â”‚
â”‚ è¯·æ±‚å¤„ç†æ€§èƒ½       â”‚ é«˜         â”‚ é«˜          â”‚ ç›¸å½“            â”‚
â”‚ å¼€å‘æ•ˆç‡           â”‚ ä¸­         â”‚ é«˜          â”‚ æ˜¾è‘—æå‡        â”‚
â”‚ ä»£ç ç»´æŠ¤æ€§         â”‚ ä¸­         â”‚ é«˜          â”‚ æ˜¾è‘—æå‡        â”‚
â”‚ é”™è¯¯å®šä½           â”‚ éš¾         â”‚ æ˜“          â”‚ æ˜¾è‘—æå‡        â”‚
â”‚ åŠŸèƒ½æ‰©å±•æ€§         â”‚ ä¸­         â”‚ é«˜          â”‚ æ˜¾è‘—æå‡        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯æ‰©å±•æ€§åˆ†æ

```typescript
// æ¨¡å—åŒ–æ‰©å±•ç¤ºä¾‹
@Module({
  imports: [
    // æ ¸å¿ƒæ¨¡å—
    MCPModule,
    OpenAPIModule,
    
    // åŠŸèƒ½æ¨¡å— (å¯é€‰)
    AuthModule,
    CacheModule,
    LoggerModule,
    MetricsModule,
    
    // ç¬¬ä¸‰æ–¹é›†æˆ (æœªæ¥æ‰©å±•)
    DatabaseModule.forRoot({...}),
    RedisModule.forRoot({...}),
    ElasticsearchModule.forRoot({...}),
  ],
  controllers: [MCPController, HealthController],
  providers: [MCPService, OpenAPIService],
})
export class AppModule {}
```

## ğŸš€ å®æ–½å»ºè®®

### è¿ç§»ç­–ç•¥

#### é˜¶æ®µ1: åŸºç¡€æ¶æ„æ­å»º (1-2å¤©)
```bash
# 1. åˆ›å»ºNestJSé¡¹ç›®
cd packages/mcp-swagger-api
npx @nestjs/cli new . --skip-git --package-manager pnpm

# 2. å®‰è£…å¿…è¦ä¾èµ–
pnpm add @nestjs/swagger @nestjs/config class-validator class-transformer

# 3. é…ç½®é¡¹ç›®ç»“æ„
mkdir -p src/{modules,guards,interceptors,filters,pipes}
```

#### é˜¶æ®µ2: æ ¸å¿ƒåŠŸèƒ½å®ç° (2-3å¤©)
```typescript
// æ¨¡å—ç»“æ„
src/
â”œâ”€â”€ app.module.ts
â”œâ”€â”€ main.ts
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ mcp/
â”‚   â”‚   â”œâ”€â”€ mcp.module.ts
â”‚   â”‚   â”œâ”€â”€ mcp.controller.ts
â”‚   â”‚   â”œâ”€â”€ mcp.service.ts
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”œâ”€â”€ openapi/
â”‚   â”‚   â”œâ”€â”€ openapi.module.ts
â”‚   â”‚   â”œâ”€â”€ openapi.service.ts
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â””â”€â”€ health/
â”‚       â”œâ”€â”€ health.module.ts
â”‚       â””â”€â”€ health.controller.ts
â”œâ”€â”€ guards/
â”‚   â””â”€â”€ mcp-session.guard.ts
â”œâ”€â”€ interceptors/
â”‚   â””â”€â”€ mcp-protocol.interceptor.ts
â”œâ”€â”€ filters/
â”‚   â””â”€â”€ mcp-exception.filter.ts
â””â”€â”€ pipes/
    â””â”€â”€ mcp-validation.pipe.ts
```

#### é˜¶æ®µ3: é›†æˆç°æœ‰ä»£ç  (1-2å¤©)
```typescript
// ç°æœ‰ä»£ç é›†æˆ
@Injectable()
export class OpenAPIService {
  constructor(
    @Inject('MCP_PARSER') private parser: typeof import('@mcp-swagger/parser')
  ) {}
  
  async parseOpenAPI(source: InputSource): Promise<ParseResult> {
    // ç›´æ¥ä½¿ç”¨ç°æœ‰çš„è§£æå™¨
    return this.parser.parseFromString(source.content);
  }
}
```

### é¡¹ç›®ç»“æ„å»ºè®®

```
packages/mcp-swagger-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.module.ts              # æ ¹æ¨¡å—
â”‚   â”œâ”€â”€ modules/                   # åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ mcp/                   # MCPåè®®å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ mcp.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mcp.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mcp.service.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ dynamic-server.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mcp-request.dto.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mcp-response.dto.ts
â”‚   â”‚   â”‚   â””â”€â”€ interfaces/
â”‚   â”‚   â”‚       â””â”€â”€ mcp.interface.ts
â”‚   â”‚   â”œâ”€â”€ openapi/               # OpenAPIå¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ openapi.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ parser.service.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ validator.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â”œâ”€â”€ parse-request.dto.ts
â”‚   â”‚   â”‚       â””â”€â”€ parse-response.dto.ts
â”‚   â”‚   â”œâ”€â”€ config/                # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ config.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚   â”‚       â””â”€â”€ config.service.ts
â”‚   â”‚   â””â”€â”€ health/                # å¥åº·æ£€æŸ¥
â”‚   â”‚       â”œâ”€â”€ health.module.ts
â”‚   â”‚       â””â”€â”€ controllers/
â”‚   â”‚           â””â”€â”€ health.controller.ts
â”‚   â”œâ”€â”€ common/                    # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ guards/
â”‚   â”‚   â”‚   â””â”€â”€ mcp-session.guard.ts
â”‚   â”‚   â”œâ”€â”€ interceptors/
â”‚   â”‚   â”‚   â”œâ”€â”€ mcp-protocol.interceptor.ts
â”‚   â”‚   â”‚   â””â”€â”€ logging.interceptor.ts
â”‚   â”‚   â”œâ”€â”€ filters/
â”‚   â”‚   â”‚   â””â”€â”€ mcp-exception.filter.ts
â”‚   â”‚   â”œâ”€â”€ pipes/
â”‚   â”‚   â”‚   â””â”€â”€ validation.pipe.ts
â”‚   â”‚   â””â”€â”€ decorators/
â”‚   â”‚       â””â”€â”€ mcp-endpoint.decorator.ts
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ response.util.ts
â”‚       â””â”€â”€ validation.util.ts
â”œâ”€â”€ test/                          # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ app.e2e-spec.ts
â”‚   â””â”€â”€ mcp/
â”‚       â””â”€â”€ mcp.controller.spec.ts
â”œâ”€â”€ docs/                          # æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md
â”‚   â””â”€â”€ deployment.md
â”œâ”€â”€ package.json
â”œâ”€â”€ nest-cli.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ .env.example
```

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### 1. ä»£ç ç»„ç»‡

```typescript
// ä½¿ç”¨è£…é¥°å™¨ä¼˜åŒ–ä»£ç ç»“æ„
@ApiTags('MCP Protocol')
@Controller('mcp')
@UseGuards(MCPSessionGuard)
@UseInterceptors(MCPProtocolInterceptor)
export class MCPController {
  
  @Post()
  @ApiOperation({ summary: 'Handle MCP requests' })
  @ApiBody({ type: MCPRequestDto })
  @ApiResponse({ status: 200, type: MCPResponseDto })
  async handleMCP(
    @Body() request: MCPRequestDto,
    @Headers('mcp-session-id') sessionId?: string
  ): Promise<MCPResponseDto> {
    return this.mcpService.handleRequest(request, sessionId);
  }
}
```

### 2. ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ

```typescript
// æœåŠ¡å±‚ä¾èµ–æ³¨å…¥
@Injectable()
export class MCPService {
  constructor(
    private readonly dynamicServerService: DynamicServerService,
    private readonly openApiService: OpenAPIService,
    private readonly configService: ConfigService,
    private readonly logger: Logger
  ) {}
  
  async handleRequest(request: MCPRequestDto, sessionId?: string): Promise<MCPResponseDto> {
    this.logger.log(`Processing MCP request: ${request.method}`);
    // ä¸šåŠ¡é€»è¾‘å¤„ç†
  }
}
```

### 3. é…ç½®ç®¡ç†

```typescript
// ç¯å¢ƒé…ç½®ç®¡ç†
@Injectable()
export class AppConfigService {
  constructor(private configService: ConfigService) {}
  
  get mcpPort(): number {
    return this.configService.get<number>('MCP_PORT', 3322);
  }
  
  get corsOrigins(): string[] {
    return this.configService.get<string>('CORS_ORIGINS', 'http://localhost:5173').split(',');
  }
}
```

## ğŸŠ ç»“è®º

NestJS æ˜¯å®ç° MCP Swagger API çš„æœ€ä½³é€‰æ‹©ï¼Œå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒä¼˜åŠ¿ï¼š

### âœ… å¼ºçƒˆæ¨èçš„ç†ç”±
1. **å®Œç¾çš„æŠ€æœ¯å¥‘åˆåº¦**: TypeScriptåŸç”Ÿæ”¯æŒï¼Œä¸ç°æœ‰é¡¹ç›®æ— ç¼é›†æˆ
2. **ä¼ä¸šçº§æ¶æ„**: æ¨¡å—åŒ–ã€ä¾èµ–æ³¨å…¥ã€ä¸­é—´ä»¶ç³»ç»Ÿ
3. **å¼€å‘æ•ˆç‡æå‡**: è£…é¥°å™¨é©±åŠ¨ï¼Œä»£ç ç®€æ´ä¼˜é›…
4. **ç”Ÿäº§å°±ç»ª**: å†…ç½®å®‰å…¨ã€ç›‘æ§ã€æµ‹è¯•ç­‰ä¼ä¸šçº§ç‰¹æ€§
5. **ç”Ÿæ€ç³»ç»Ÿä¸°å¯Œ**: æ’ä»¶ã€ä¸­é—´ä»¶ã€å·¥å…·é“¾å®Œå–„
6. **å­¦ä¹ æˆæœ¬ä½**: åŸºäºExpressï¼Œå›¢é˜Ÿå®¹æ˜“ä¸Šæ‰‹

### ğŸ“Š æŠ•èµ„å›æŠ¥åˆ†æ
- **å¼€å‘æ—¶é—´**: å‡å°‘30-50%çš„å¼€å‘æ—¶é—´
- **ä»£ç è´¨é‡**: æé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§
- **è¿ç»´æˆæœ¬**: å†…ç½®ç›‘æ§å’Œå¥åº·æ£€æŸ¥ï¼Œé™ä½è¿ç»´å¤æ‚åº¦
- **æ‰©å±•æ€§**: æ¨¡å—åŒ–æ¶æ„ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•

### ğŸš€ è¡ŒåŠ¨å»ºè®®
1. **ç«‹å³é‡‡ç”¨**: æŠ€æœ¯é£é™©ä½ï¼Œæ”¶ç›Šæ˜æ˜¾
2. **æ¸è¿›å¼è¿ç§»**: å…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œå†é€æ­¥å®Œå–„
3. **å›¢é˜ŸåŸ¹è®­**: è™½ç„¶å­¦ä¹ æˆæœ¬ä¸é«˜ï¼Œä½†å»ºè®®è¿›è¡ŒåŸºç¡€åŸ¹è®­
4. **æœ€ä½³å®è·µ**: éµå¾ªNestJSå®˜æ–¹æ¨èçš„é¡¹ç›®ç»“æ„å’Œç¼–ç è§„èŒƒ

**æ€»ç»“**: NestJS ä¸ä»…å®Œå…¨æ»¡è¶³é¡¹ç›®éœ€æ±‚ï¼Œè¿˜èƒ½æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ï¼Œå¼ºçƒˆå»ºè®®é‡‡ç”¨ã€‚
